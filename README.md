# BINANCE BOT v0.9.0 RC

## ЛОКАЛЬНЫЕ НАСТРОЙКИ

Бот умеет торговать по нескольким парам одновременно. Пропишите пары, по которым будет идти торговля (см. [пример](https://prnt.sc/kyo6kz)). Каждую пару можно конфигурировать независимыми настройками. Они называются локальными настройками.

* quote - это квотируемая валюта (соответствует цене). Обязательный параметр. Допустимые значения: "BTC", "ETH", "BNB", "USDT".
* base - это базовая валюта (соответствует количеству). Например, для торгов по паре NEO/USDT базовая валюта - NEO, квотируемая - USDT. Обязательный параметр.
* interval - интервал свечей, используется индикаторами и стратегией SCALPING. По умолчанию: "5m". Допустимые значения: ["1m", "3m", "5m", "15m", "30m", "1h", "2h", "4h", "6h", "8h", "12h", "1d", "3d", "1w", "1M"].
* macd_fast_period - период быстрой скользящей. По умолчанию: 12.
* macd_slow_period - период медленной скользящей. По умолчанию: 26.
* macd_signal_period - период сигнальной скользящей. По умолчанию: 9.
* dom_offers_amount - сколько предложений из стакана берём для расчёта средней цены. По умолчанию: 5. Допустимые значения: [5, 10, 20, 50, 100, 500, 1000].
* scalp_min - количество последних свечей без учёта текущей, low prices которых следует использовать для расчёта наименьшей цены. По умолчанию: 4. Используйте значение 0 для отключения проверки по данному условию.
* scalp_red - количество последних красных свечей с учётом текущей, необходимых для того, чтобы ситуация на рынке стала считаться благоприятной для покупки. По умолчанию: 2. Используйте значение 0 для отключения проверки по данному условию.
* scalp_delay - задержка перед началом торгов. По умолчанию: 0.5. Допустимые значения: от 0 до 1, где 0 - начало свечи, 1 - конец свечи. Используйте значение 0 для отключения проверки по данному условию.
* scalp_low_price_markup - наценка для low price текущей свечи, которая будет использоваться для вычисления цены покупки. По умолчанию: 0.2 (=20%).
* dk_extra_interval - интервал для дополнительного анализа индикатора Stochastic RSI. По умолчанию "15m". Допустимые значения: ["1m", "3m", "5m", "15m", "30m", "1h", "2h", "4h", "6h", "8h", "12h", "1d", "3d", "1w", "1M"].
* dk_delay - задержка перед началом торгов. По умолчанию: 0.5. Допустимые значения: от 0 до 1, где 0 - начало свечи, 1 - конец свечи. Используйте значение 0 для отключения проверки по данному условию.
* dk_low_price_markup - наценка для low price текущей свечи, которая будет использоваться для вычисления цены покупки. По умолчанию: 0.2 (=20%).
* spending_sum - сколько quote тратить каждый раз при покупке base. По умолчанию: 0.5.
* profit - какой навар нужен с каждой сделки. Комиссия учитывается только при торговле без использования BNB. По умолчанию: 0.01 (=1%).
* use_stop_loss - нужно ли продавать с убытком при падении цены. По умолчанию: false. Допустимые значения: true, false.
* stop_loss - на сколько должна упасть цена, чтобы продавать с убытком. По умолчанию: 2.5 (=2.5%).

## ГЛОБАЛЬНЫЕ НАСТРОЙКИ

Глобальные настройки - это настройки, одинаковые для всех пар.

* api_key - обязательный параметр.
* secret_key - обязательный параметр.
* spending_system - в чём исчислять затраты на покупку base: "fixed" - в виде количества base для покупки, "dynamic" - в виде процента от общей суммы квотируемой валюты, имеющейся в распоряжении (1 = 100%). По умолчанию: "dynamic".
* buy_strategy - подробнее ниже. По умолчанию: "dynamic_klines". Допустимые значения: "dom", "scalping", "dynamic_klines".
* sell_strategy - подробнее ниже. По умолчанию: "scalping". Допустимые значения: "dom", "scalping".
* buy_life_time_sec - сколько (в секундах) держать ордер на продажу открытым. По умолчанию: 300.
* clear_logs - следует ли очищать логи при запуске. По умолчанию: true. Допустимые значения: true, false.
* clear_db - следует ли очищать базу данных при запуске. По умолчанию: true. Допустимые значения: true, false.
* stock_fee - комиссия, которую берет биржа. По умолчанию: 0.001 (=0.1%).
* use_bnb_fees - использовать ли BNB при оплате комиссии. По умолчанию: true. Допустимые значения: true, false.
* macd_bull_perc - процент для торговли при падении рынка. По умолчанию: 30. Допустимые значения: любое рациональное число от 0 до 100.
* macd_bear_perc - процент для торговли при росте рынка. По умолчанию: 70. Допустимые значения: любое рациональное число от 0 до 100.
* stochrsi_perc - процент, ниже которого должно находиться текущее значение stochastic rsi D, чтобы условия для торговли считались благоприятными. По умолчанию: 50. Допустимые значения: любое рациональное число от 0 до 100.

## BUY-СТРАТЕГИЯ SCALPING

Префикс - scalp.

Покупка по данной стратегии будет совершена в том и только в том случае, если:

1. Последние N свечей (локальный параметр scalp_red) были красными И
2. low price текущей свечи ниже, чем low prices предыдущих N свечей ( локальный параметр scalp_min) И
3. Прошло N времени с момента начала последней свечи (локальный параметр scalp_delay) И
4. Индикатор MACD при текущих настройках разрешает торговлю И
5. Индикатор STOCHASTIC RSI при текущих настройках разрешает торговлю

Цена формируется по формуле: low price текущей свечи + наценка (локальный параметр scalp_low_price_markup), которая представляет собой процент от высоты текущей свечи.

## SELL-СТРАТЕГИЯ SCALPING

Префикс - scalp.

Данная стратегия ожидает:

1. Начала первого бычьего тренда И
2. Перекупленности более 55%,

а после проверяет ряд условий. Если:

1. Рынок бычий И
2. Рынок перекуплен более чем на 55% И
3. high price текущей свечи выше, чем high price предыдущей,

то ожидать следующей свечи.

Если одно из вышеперечисленных условий не соблюдено, то проверять до того момента, пока не пройдёт половина жизни свечи. Если во второй половине условия всё ещё не будут соблюдены, то сравнить текущую рыночную цену с (цена покупки + минимально желаемый профит), выбрать наибольшее значение цены и выставить ордер по нему.

## BUY-СТРАТЕГИЯ DEPTH-OF-MARKET

Префикс - dom.

Данная стратегия ориентируется на последние предложения из стакана.
Цена для ордера рассчитывается как среднее арифметическое цен последних N предложений из стакана (N устанавливается через локальный параметр dom_offers_amount).

## SELL-СТРАТЕГИЯ DEPTH-OF-MARKET

Префикс - dom.

Данная стратегия сравнивает текущую рыночную цену с ценой, рассчитанной исходя из желаемого профита (устанавливается через локальный параметр profit), выбирает ту, что больше, и закупается по ней.

## BUY-СТРАТЕГИЯ DYNAMIC-KLINES

Префикс - dk.

Покупка по данной стратегии будет совершена в том и только в том случае, если:

1. Рынок начал разворот (т.е. low price каждой следующей свечи был ниже, чем low price предыдущей, но low price последней свечи выше, чем low price предпоследней) И
2. Текущая рыночная цена ниже цены открытия предпоследней свечи И
3. Прошло N времени с момента начала последней свечи (локальный параметр scalp_delay) И
4. Индикатор MACD при текущих настройках разрешает торговлю И
5. Индикатор STOCHASTIC RSI на основном интервале (локальный параметр interval) при текущих настройках разрешает торговлю И
6. Индикатор STOCHASTIC RSI на дополнительном интервале (локальный параметр dk_extra_interval) при текущих настройках разрешает торговлю

Цена формируется по формуле: low price текущей свечи + наценка (локальный параметр dk_low_price_markup), которая представляет собой процент от высоты текущей свечи.

## ИНДИКАТОР MACD

Бот будет торговать в такие моменты:

1. Когда график падал, но начал расти (в самом конце падения)
2. Когда график начал расти, растет и не наметил тенденцию к падению (торговать во время роста, прекратить ближе к концу). См. [пример](https://prnt.sc/ky9xis)

Алгоритм индикатора MACD работает следующим образом: мы берем разницу между двумя линиями MACD и сравниваем с максимальной разницей линий MACD за период от одного изменения тренда до другого. Каждый раз, когда тренд разворачивается (пересечение линий), мы обнуляем этот максимум.

Таким образом, после разворота тренда первая разница между двумя линиями будет максимальной (100% разницей). После этого, если линии еще сильнее разойдутся, то уже следующая разница между линиями станет максимальной. В тот момент, когда линии начнут сходиться, разница уже не будет максимальной, а будет убывать (90%, 80%) и т.д.

Поэтому для торгов будут использоваться две настроечные переменные:

Если рынок бычий (растет), то торгуй, пока разница больше X%. В таком случае он будет торговать на бычьем рынке с момента разворота тренда до тех пор, пока линии не начнут плотно сходиться.

Если рынок медвежий (падает), то торгуй тогда, когда разница между линиями меньше (100-Y)%. В таком случае он включится в торговлю только после того, как тренд развернется, линии разойдутся на максимум, потом сойдутся почти полностью.

Каждое из этих значений может колебаться от 0 до 100, не обязательно, чтобы они в сумме что-то давали, они независимые.

Если установить параметр macd_bear_perc в 0, то торговля будет происходить на всём медвежьем рынке, если установить параметр macd_bull_perc в 0, - то на всём бычьем. И наоборот, macd_bear_perc, установленный в 100, запретит торговлю на медвежьем рынке, а macd_bull_perc, установленный в 100, - на бычьем.

## ИНДИКАТОР STOCHASTIC RSI

Бот будет торговать при двух условиях:

1. Если скользящая stochastic rsi D находится выше скользящей stochastic rsi K
2. Если текущее значение stochastic rsi D ниже порога, установленного глобальным параметром stochrsi_perc

## ТРЕБОВАНИЯ

* Python 3.6 и выше (на более ранних версиях работоспособность не гарантируется)
* пакет requests
* пакет Ta-Lib (подробнее об установке читайте на [сайте](https://github.com/mrjbq7/ta-lib))
* пакет numpy
* пакет pandas

## УСТАНОВКА

На Windows: запустить setup.bat

## ЗАПУСК

На Windows:

1. Сконфигурировать бота и добавить свои API KEY и API SECRET в соответствующие параметры
2. Запустить run.bat

## ОБРАТНАЯ СВЯЗЬ

При обнаружении багов в работе бота, а также об идеях и предложениях сообщайте в личных сообщениях в ВК.
